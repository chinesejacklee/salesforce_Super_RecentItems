Function.prototype.method=function(name,func){this.prototype[name]=func;return this};Function.method("inherits",function(parent){var d=0;var p=this.prototype=new parent;this.method("base",function base(name){var f;var t=d;var v=parent.prototype;if(t){while(t){v=v.constructor.prototype;t-=1}f=v[name]}else{f=p[name];if(f==this[name]){f=v[name]}}d+=1;var r=f.apply(this,Array.prototype.slice.apply(arguments,[1]));d-=1;return r});return this});Function.method("swiss",function(parent){for(var i=1;i<arguments.length;++i){var name=arguments[i];this.prototype[name]=parent.prototype[name]}return this});String.format=function(formatString){if(arguments.length<2){return formatString}var replArray=arguments;return formatString.replace(/\{(\d+)\}/g,function(match,i){return replArray[+i+1]})};function createAttribute(name,value){var attr=document.createAttribute(name);attr.nodeValue=value;return attr}function BarCodeUI(nodeID){var self=this;var codeInputID="codeInput";var descInputID="descInput";var displayBtnID="displayBtn";var countryDispID=String.format("{0}_countryCode",nodeID);var group1DispID=String.format("{0}_group1",nodeID);var group2DispID=String.format("{0}_group2",nodeID);var descDispID=String.format("{0}_desc",nodeID);var codeInput=document.getElementById(codeInputID);var descInput=document.getElementById(descInputID);var countryDisp=document.getElementById(countryDispID).firstChild;var group1Disp=document.getElementById(group1DispID).firstChild;var group2Disp=document.getElementById(group2DispID).firstChild;var descDisp=document.getElementById(descDispID).firstChild;var displayBtn=document.getElementById(displayBtnID);var digits=["",String.format("{0}_digit01",nodeID),String.format("{0}_digit02",nodeID),String.format("{0}_digit03",nodeID),String.format("{0}_digit04",nodeID),String.format("{0}_digit05",nodeID),String.format("{0}_digit06",nodeID),String.format("{0}_digit07",nodeID),String.format("{0}_digit08",nodeID),String.format("{0}_digit09",nodeID),String.format("{0}_digit10",nodeID),String.format("{0}_digit11",nodeID),String.format("{0}_digit12",nodeID)];BarCodeUI.method("GetCodeInput",function(){return codeInput.value});BarCodeUI.method("SetCodeInput",function(value){codeInput.value=value});BarCodeUI.method("SetDigit",function(pos,pattern){var digitNode=document.getElementById(digits[pos]);var bits=digitNode.getElementsByTagName("div");for(var j=0;j<bits.length;++j){bits[j].setAttributeNode(createAttribute("class",pattern[j]?"bitOn":"bitOff"))}});BarCodeUI.method("DisplayText",function(){var code=codeInput.value;var countryCode=code.charAt(0);var group1=code.substring(1,7);var group2=code.substring(7,13);countryDisp.nodeValue=countryCode;group1Disp.nodeValue=group1;group2Disp.nodeValue=group2;descDisp.nodeValue=descInput.value;codeInput.focus()});BarCodeUI.method("NodeID",function(){return nodeID});BarCodeUI.method("GetCode",function(){return codeInput.value});BarCodeUI.method("GetDesc",function(){return descInput.value});BarCodeUI.method("WireEvents",function(){codeInput.onkeydown=function(event){BarCodeUI.onEditorKeyDown(event)};codeInput.onkeyup=function(event){BarCodeUI.onEditorKeyUp(event)}});BarCodeUI.lengthCheckScheduled=0;BarCodeUI.lengthCheckTimeout=100;BarCodeUI.testLength=function(){if(BarCodeUI.lengthCheckScheduled){clearTimeout(BarCodeUI.lengthCheckScheduled)}BarCodeUI.lengthCheckScheduled=0;var length=codeInput.value.length;var isInvalid=length<11||length>13||parseInt(codeInput.value)==NaN;document.getElementById("displayBtn").disabled=isInvalid;return isInvalid};BarCodeUI.onEditorKeyDown=function(event){if(BarCodeUI.lengthCheckScheduled){clearTimeout(BarCodeUI.lengthCheckScheduled);BarCodeUI.lengthCheckScheduled=setTimeout("BarCodeUI.testLength()",BarCodeUI.lengthCheckTimeout)}};BarCodeUI.onEditorKeyUp=function(event){if(event.charCode){key=event.charCode}else{key=event.keyCode}if(BarCodeUI.lengthCheckScheduled){clearTimeout(BarCodeUI.lengthCheckScheduled)}BarCodeUI.lengthCheckScheduled=setTimeout("BarCodeUI.testLength()",BarCodeUI.lengthCheckTimeout)}}function BarCodeGenerator(){var self=this;BarCodeGenerator.method("Generate",function(ui){var retVal=0;var code=ui.GetCodeInput();code=code+this.CalculateChecksumDigit(code);ui.SetCodeInput(code);for(var i=1;i<code.length;++i){}ui.DisplayText();return retVal});BarCodeGenerator.method("CalculateChecksumDigit",function(code){var checkSum=0;return checkSum})}function EAN13Generator(){var odd=[[0,0,0,1,1,0,1],[0,0,1,1,0,0,1],[0,0,1,0,0,1,1],[0,1,1,1,1,0,1],[0,1,0,0,0,1,1],[0,1,1,0,0,0,1],[0,1,0,1,1,1,1],[0,1,1,1,0,1,1],[0,1,1,0,1,1,1],[0,0,0,1,0,1,1]];var even=[[0,1,0,0,1,1,1],[0,1,1,0,0,1,1],[0,0,1,1,0,1,1],[0,1,0,0,0,0,1],[0,0,1,1,1,0,1],[0,1,1,1,0,0,1],[0,0,0,0,1,0,1],[0,0,1,0,0,0,1],[0,0,0,1,0,0,1],[0,0,1,0,1,1,1]];var right=[[1,1,1,0,0,1,0],[1,1,0,0,1,1,0],[1,1,0,1,1,0,0],[1,0,0,0,0,1,0],[1,0,1,1,1,0,0],[1,0,0,1,1,1,0],[1,0,1,0,0,0,0],[1,0,0,0,1,0,0],[1,0,0,1,0,0,0],[1,1,1,0,1,0,0]];var parity=[[odd,odd,odd,odd,odd,odd],[odd,odd,even,odd,even,even],[odd,odd,even,even,odd,even],[odd,odd,even,even,even,odd],[odd,even,odd,odd,even,even],[odd,even,even,odd,odd,even],[odd,even,even,even,odd,odd],[odd,even,odd,even,odd,even],[odd,even,odd,even,even,odd],[odd,even,even,odd,even,odd]];var self=this;EAN13Generator.method("Generate",function(ui){var retVal=0;var code=ui.GetCodeInput();if(code.length>12){code=code.substring(0,12)}else if(code.length==11){code="0"+code}code=code+this.CalculateChecksumDigit(code);ui.SetCodeInput(code);var parityDigit=parseInt(code.charAt(0));var parityTable=parity[parityDigit];for(var i=1;i<code.length;++i){var num=+code.charAt(i);var pattern=null;if(i<7){pattern=parityTable[i-1][num]}else{pattern=right[num]}ui.SetDigit(i,pattern)}ui.DisplayText();return retVal});EAN13Generator.method("CalculateChecksumDigit",function(code){var sum=0;var digit=0;for(var i=code.length;i>=1;--i){digit=parseInt(code.substring(i-1,i));if(i%2==0){sum+=digit*3}else{sum+=digit*1}}var checkSum=(10-sum%10)%10;return checkSum});EAN13Generator.inherits(BarCodeGenerator)}var barcodeObjects=null;function window_onload(){barcodeObjects={'EAN-13':{generator:new EAN13Generator,ui:new BarCodeUI("EAN-13")}};barcodeObjects['EAN-13'].ui.WireEvents();var displayBtn=document.getElementById("displayBtn");displayBtn.onclick=function(){barcodeObjects['EAN-13'].generator.Generate(barcodeObjects['EAN-13'].ui)};barcodeObjects['EAN-13'].generator.Generate(barcodeObjects['EAN-13'].ui)}window.onload=window_onload;